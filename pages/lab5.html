<!DOCTYPE html>
<html><head><title>lab 5</title>

  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="http://npmcdn.com/leaflet@0.7.7/dist/leaflet.css">
  <script src="http://npmcdn.com/leaflet@0.7.7/dist/leaflet.js"></script>
  
  <style>


    a.nav:link    {color:white; background-color:transparent; text-decoration:none}
    a.nav:visited {color:white; background-color:transparent; text-decoration:none}
    a.nav:hover   {color:#00ffff; background-color:transparent; text-decoration:none}
    a.nav:active  {color:white; background-color:transparent; text-decoration:none}


    .info {
      padding: 12px;
      font: 16px Arial, sans-serif;
      background: white;
      background: rgba(255,255,255,0.8);
      box-shadow: 0 0 15px rgba(0,0,0,0.2);
      border-radius: 10px;
    }

    .info h4 {
      margin: 0 0 5px;
      color: black;
    }

    .legend {
      text-align: left;
      line-height: 24px;
      color: #555;
    }

    .legend i {
      width: 24px;
      height: 24px;
      float: left;
      margin-right: 8px;
      opacity: .65;
    }

    .leaflet-popup-close-button {
        display:none;
    }

    .leaflet-label-overlay {
        line-height: 0px;
        margin-top: 12px;
        position: absolute;
        padding: 12px;
        font: 14px Arial, sans-serif;
        text-shadow: -1px 0 white, 0 1px white,
      1px 0 white, 0 -1px white
    }

  </style>

</head>

<body>

<table style="text-align: left; width: 80%; margin-left: auto; margin-right: auto; height: 852px;" border="0" cellpadding="2" cellspacing="2">

  <tbody>
    <tr>
      <td style="vertical-align: top; height: 1200px;">
      <table style="text-align: left; width: 1157px; height: 1196px;" border="0" cellpadding="2" cellspacing="2">
        <tbody>
          <tr>
            <td style="vertical-align: top; width: 124px; height: 120px;"><img style="width: 128px; height: 128px;" alt="" src="../images/location.png"><br>
            </td>
            <td style="vertical-align: top; width: 1013px; height: 120px;">
            <table style="text-align: left; width: 1007px; height: 172px;" border="0" cellpadding="2" cellspacing="2">
              <tbody>
                <tr>
                  <td style="vertical-align: top; width: 165px; text-align: center; height: 166px;"><big style="color: rgb(219, 29, 70);"><big><big><span style="font-family: Arial; font-weight: bold;">geog</span></big></big></big><big style="color: rgb(219, 29, 70);"><big><big><span style="font-family: Arial; font-weight: bold;"></span></big></big></big><br>
                  <big style="color: rgb(222, 77, 108);"><big><big><span style="font-family: Arial; font-weight: bold;">771</span></big></big></big><span style="font-family: Arial; font-weight: bold; color: rgb(219, 29, 70);"><br>
2016&nbsp; </span><span style="font-family: Arial; font-weight: bold; color: rgb(219, 29, 70);">|&nbsp;
                  </span><span style="font-family: Arial; font-weight: bold; color: rgb(219, 29, 70);">sem
2<br>
                  </span><span style="font-family: Arial; color: rgb(219, 29, 70);"><font size="-1">university
of auckland</font></span><span style="font-family: Arial; font-weight: bold; color: rgb(219, 29, 70);"><br>
                  </span> </td>
                  <td style="vertical-align: top; width: 822px; text-align: center; height: 166px;"><big style="color: rgb(219, 29, 70);"><big><big><span style="font-family: Arial; font-weight: bold;"><br>
                  </span></big></big></big>
                  <div style="text-align: center;"><big style="color: rgb(219, 29, 70);"><big><big><span style="font-family: Arial; font-weight: bold;">lab</span></big></big></big><big style="color: rgb(219, 29, 70);"><big><big><span style="font-family: Arial; font-weight: bold;"></span></big></big></big><big style="color: rgb(222, 77, 108);"><big><big><span style="font-family: Arial; font-weight: bold;"> 5</span></big></big></big><span style="font-family: Arial; font-weight: bold; color: rgb(219, 29, 70);"></span><big><big><span style="font-family: Arial; font-weight: bold; color: rgb(219, 29, 70);"><br>
social media mapping: Twitter edition </span></big></big><big><big><span style="font-family: Arial; font-weight: bold;"></span></big></big><small><span style="font-family: Arial; font-weight: bold; color: rgb(219, 29, 70);"></span></small><br>
                  </div>
                  <span style="font-family: Arial; font-weight: bold; color: rgb(219, 29, 70);"></span></td>
                </tr>
              </tbody>
            </table>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top; width: 124px; height: 35px;"><br>
            </td>
            <td style="vertical-align: top; width: 1013px; height: 35px;">
            <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
              <tbody>
                <tr>
                  <td style="vertical-align: top; background-color: rgb(215, 37, 73);">
                  <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
                    <tbody>
                      <tr>
                        <td style="vertical-align: top; font-family: Arial; font-weight: bold; color: rgb(219, 29, 70); width: 120px;"><a class="nav"; href="../index.html" target="_top"><span>home</span></a><br>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  </td>
                  <td style="vertical-align: top; background-color: rgb(215, 37, 73);">
                  <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
                    <tbody>
                      <tr>
                        <td style="vertical-align: top; font-family: Arial; font-weight: bold; color: rgb(219, 29, 70); width: 120px;"><a class="nav"; href="lab2.html" target="_top"><span>lab 2</span></a><br>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  </td>
                  <td style="vertical-align: top; background-color: rgb(215, 37, 73);">
                  <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
                    <tbody>
                      <tr>
                        <td style="vertical-align: top; font-family: Arial; font-weight: bold; color: rgb(219, 29, 70); width: 120px;"><a class="nav"; href="lab3.html" target="_top"><span>lab 3</span><br>
                        </a></td>
                      </tr>
                    </tbody>
                  </table>
                  </td>
                  <td style="vertical-align: top; background-color: rgb(215, 37, 73);">
                  <table style="text-align: left; width: 100%;" border="0" cellpadding="2" cellspacing="2">
                    <tbody>
                      <tr>
                        <td style="vertical-align: top; font-family: Arial; font-weight: bold; color: rgb(219, 29, 70); width: 120px;"><a class="nav"; href="lab4.html" target="_top"><span>lab 4</span><br>
                        </a></td>
                      </tr>
                    </tbody>
                  </table>
                  </td>
                  <td style="vertical-align: top; background-color: rgb(215, 37, 73); text-align: center;">
                  <table style="text-align: left; width: 100%; margin-left: auto; margin-right: auto;" border="0" cellpadding="2" cellspacing="2">
                    <tbody>
                      <tr>
                        <td style="vertical-align: top; font-family: Arial; font-weight: bold; color: rgb(219, 29, 70); width: 120px;"><a class="nav"; href="lab5.html" target="_top"><span>lab 5</span><br>
                        </a></td>
                      </tr>
                    </tbody>
                  </table>
                  </td>
                </tr>
              </tbody>
            </table>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top; width: 124px; height: 12px;"><br>
            </td>
            <td style="vertical-align: top; width: 1013px; height: 12px;"><br>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top; width: 124px; height: 66px;"><br>
            </td>
            <td style="vertical-align: middle; width: 1013px; height: 66px; font-family: Arial; text-align: center;">
            <div style="text-align: center; height: 69px;"><big style="color: rgb(219, 29, 70);"><big><big><span style="font-family: Arial; font-weight: bold;">where does nz tweet more about sheep vs the all blacks? </span></big></big></big><br>
            <span style="font-family: Arial; color: rgb(219, 29, 70);"></span><br>
            <span style="font-family: Arial; font-weight: bold; color: rgb(219, 29, 70);"></span></div>
            </td>
          </tr>
          <tr>
            <td style="vertical-align: top; width: 124px; height: 1000px;"><br>
            </td>
            <td style="vertical-align: top; width: 1013px; height: 1000px;">


 
<div id="map" style="width: 100%; height: 820px;"></div>

<script type="text/javascript" src="../js/tweetsHex.js"></script>
<script type="text/javascript" src="../js/emptyHex.js"></script>

<script>
  
  var map = L.map('map').setView([-41.25, 174.832360900752], 6);
  
  L.tileLayer('http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png', 
     {
    attribution: 'Map tiles &copy; <a href="http://cartodb.com/attributions">Carto </a>| Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> | Twitter data &copy; <a href="https://twitter.com/mattzook"> @mattzook</a> & <a href="http://www.floatingsheep.org/p/dolly.html">Floating Sheep</a>',
         }).addTo(map);


 // colour hexbins by joint count property

    // // define colur palet

    function getColor(d) {
      return  d > 1.1 ? '#1ad1ff' :
              d > 0.9  ? '#ffff80' :
              d > 0.1  ? '#ff4dff' :
              d > 0  ? '#ff4dff' :
                       '1ad1ff';
  }

      // // colour the features

    function style(feature) {
      return {
          fillColor: getColor(feature.properties.TweetsLQ),
          weight: 1,
          opacity: 1,
          color: 'grey',
          fillOpacity: 1
      };
  }

// define the geojson variable

  L.geoJson(tweetsHex, {
  style: style
}).addTo(map);

  L.geoJson(emptyHex, {
          color: "grey",
          weight: 1,
          opacity: 1,
          fillOpacity: 0
    }).addTo(map);


// create label overlay class

L.LabelOverlay = L.Class.extend({
        initialize: function(/*LatLng*/ latLng, /*String*/ label, options) {
            this._latlng = latLng;
            this._label = label;
            L.Util.setOptions(this, options);
        },
        options: {
            offset: new L.Point(0, 2)
        },
        onAdd: function(map) {
            this._map = map;
            if (!this._container) {
                this._initLayout();
            }
            map.getPanes().overlayPane.appendChild(this._container);
            this._container.innerHTML = this._label;
            map.on('viewreset', this._reset, this);
            this._reset();
        },
        onRemove: function(map) {
            map.getPanes().overlayPane.removeChild(this._container);
            map.off('viewreset', this._reset, this);
        },
        _reset: function() {
            var pos = this._map.latLngToLayerPoint(this._latlng);
            var op = new L.Point(pos.x + this.options.offset.x, pos.y - this.options.offset.y);
            L.DomUtil.setPosition(this._container, op);
        },
        _initLayout: function() {
            this._container = L.DomUtil.create('div', 'leaflet-label-overlay');
        }
    });  

// add text labels:
    var labelLocation = new L.LatLng(-36.820556, 174.74);
    var labelTitle = new L.LabelOverlay(labelLocation, '<b>AUCKLAND</b>');
    map.addLayer(labelTitle);


    var labelLocation2 = new L.LatLng(-41.288889, 174.777222);
    var labelTitle2 = new L.LabelOverlay(labelLocation2, '<b>WELLINGTON</b>');
    map.addLayer(labelTitle2);

    var labelLocation3 = new L.LatLng(-43.53, 172.620278);
    var labelTitle3 = new L.LabelOverlay(labelLocation3, '<b>CHRISTCHURCH</b>');
    map.addLayer(labelTitle3);

    var labelLocation4 = new L.LatLng(-45.866667, 169.5);
    var labelTitle4 = new L.LabelOverlay(labelLocation4, '<b>DUNEDIN</b>');
    map.addLayer(labelTitle4);

    var labelLocation5 = new L.LatLng(-37.783333, 175.283333);
    var labelTitle5 = new L.LabelOverlay(labelLocation5, '<b>HAMILTON</b>');
    map.addLayer(labelTitle5);

    var labelLocation6 = new L.LatLng(-41.270833, 173.283889);
    var labelTitle6 = new L.LabelOverlay(labelLocation6, '<b>NELSON</b>');
    map.addLayer(labelTitle6);


    // In order to prevent the text labels to "jump" when zooming in and out,
    // in Google Chrome, I added this event handler:

    map.on('movestart', function () {
        map.removeLayer(labelTitle);
        map.removeLayer(labelTitle2);
        map.removeLayer(labelTitle3);
        map.removeLayer(labelTitle4);
        map.removeLayer(labelTitle5);
        map.removeLayer(labelTitle6);
    });
    map.on('moveend', function () {
        map.addLayer(labelTitle);
        map.addLayer(labelTitle2);
        map.addLayer(labelTitle3);
        map.addLayer(labelTitle4);
        map.addLayer(labelTitle5);
        map.removeLayer(labelTitle6);
    });

// legend from Britta

    //var legend = L.control({position: 'bottomright'});

    //legend.onAdd = function (map) {

// var div = L.DomUtil.create('div', 'info legend'),
     //   grades = [0.1, 0.9, 1.1, ],
     //   key_labels = [ "more All Blacks Tweets", "~ equal All Blacks/sheep Tweeting", "more sheep Tweets"],
     //   labels = ['<strong>Relative Intensity of Tweeting about Sheep vs. All Blacks</strong>'],
      //  from, to;

                

      //for (var i = 0; i < grades.length; i++) {
       // from = grades[i];
       // to = grades[i + 1];

       // labels.push(
         // '<i style="background:' + getColor(from + 1) + '"></i> ' +
         //  key_labels[i]);
     // }

    //  div.innerHTML = labels.join('<br>');
     // return div;
  //  };

    //legend.addTo(map);

// legend # 2

var legend = L.control({position: 'bottomright'});

                legend.onAdd = function (map) {

                    var div = L.DomUtil.create('div', 'info legend'),
                        grades = [0.1, 0.9, 1.1, ],
                        labels = ['<strong>Relative Intensity of Tweeting about Sheep vs. All Blacks</strong>'],
                        key_labels = ["more All Blacks Tweets", "~ equal All Blacks / sheep Tweeting", "more sheep Tweets"],
                        from, to;

                    for (var i = 0; i < grades.length; i++) {
                        from = grades[i];
                        to = grades[i + 1];

                        labels.push(
                            '<i style="background:' + getColor(from + '1' ) + '"></i> ' + key_labels[i]);
                                                } //changed '1' to get right colors on the legend but first field is still second green, not sure why??

                    div.innerHTML = labels.join('<br>');
                    return div;
                };

                legend.addTo(map);



</script>





<br>
            </td>
          </tr>
        </tbody>
      </table>
      </td>
    </tr>
  </tbody>
</table>

<br>

<br>
</body></html>